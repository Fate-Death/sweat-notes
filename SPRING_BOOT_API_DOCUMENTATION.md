# HyprFit Spring Boot API Documentation

This document provides complete API specifications for the HyprFit fitness tracking application. Use this to build your Spring Boot backend.

## Base Configuration

- **Base URL**: `http://localhost:5000` (update port as needed)
- **Content-Type**: `application/json` for all POST/PUT requests
- **CORS**: Enable CORS for your frontend origin
- **Credentials**: Include credentials in responses if using sessions/auth

## Data Models

### Workout Model
```java
public class Workout {
    private String id;           // UUID generated by backend
    private String name;         // User-defined workout name
    private String type;         // One of: "strength", "cardio", "flexibility", "sports", "other"
    private Integer duration;    // Duration in minutes
    private Integer intensity;   // Scale 1-10
    private LocalDateTime date;  // Auto-generated timestamp
    private String notes;        // Optional user notes
    
    // constructors, getters, setters...
}
```

### Insert Workout DTO (for POST requests)
```java
public class InsertWorkout {
    private String name;         // Required
    private String type;         // Required: "strength", "cardio", "flexibility", "sports", "other"
    private Integer duration;    // Required: minutes
    private Integer intensity;   // Required: 1-10 scale
    private String notes;        // Optional
    
    // Validation annotations
    @NotNull @NotBlank private String name;
    @NotNull @Pattern(regexp = "strength|cardio|flexibility|sports|other") private String type;
    @NotNull @Min(1) @Max(600) private Integer duration;
    @NotNull @Min(1) @Max(10) private Integer intensity;
}
```

### WorkoutPlan Model
```java
public class WorkoutPlan {
    private String id;              // UUID generated by backend
    private Integer dayOfWeek;      // 1-7 (Monday-Sunday)
    private String name;            // Plan name
    private Integer duration;       // Duration in minutes
    private Integer exerciseCount;  // Number of exercises
    private List<String> focus;     // Focus areas (muscle groups)
    private String status;          // "today", "completed", "upcoming", "rest", "flexible"
    private Integer week;           // Week number
    
    // constructors, getters, setters...
}
```

### Insert WorkoutPlan DTO
```java
public class InsertWorkoutPlan {
    @NotNull @Min(1) @Max(7) private Integer dayOfWeek;
    @NotNull @NotBlank private String name;
    @NotNull @Min(1) @Max(600) private Integer duration;
    @NotNull @Min(0) private Integer exerciseCount;
    @NotNull @NotEmpty private List<String> focus;
    @NotNull @Pattern(regexp = "today|completed|upcoming|rest|flexible") private String status;
    @NotNull @Min(1) private Integer week;
}
```

### UserStats Model
```java
public class UserStats {
    private String id;                    // UUID
    private Integer currentStreak;        // Current workout streak
    private Integer bestStreak;          // Best streak achieved
    private Integer totalWorkouts;       // Total workouts completed
    private LocalDateTime lastWorkoutDate; // Last workout timestamp
}
```

## API Endpoints

### 1. Workouts API

#### GET /api/workouts
**Purpose**: Retrieve all workouts for the user, sorted by date (newest first)

**Request**:
```http
GET /api/workouts
Accept: application/json
```

**Response**:
```http
HTTP/1.1 200 OK
Content-Type: application/json

[
  {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "name": "Morning Push-ups",
    "type": "strength", 
    "duration": 30,
    "intensity": 7,
    "date": "2025-01-08T10:30:00Z",
    "notes": "Felt strong today"
  }
]
```

**Error Responses**:
```http
HTTP/1.1 500 Internal Server Error
Content-Type: application/json

{
  "message": "Failed to fetch workouts"
}
```

---

#### POST /api/workouts
**Purpose**: Create a new workout entry

**Request**:
```http
POST /api/workouts
Content-Type: application/json

{
  "name": "Evening Run",
  "type": "cardio",
  "duration": 45,
  "intensity": 8,
  "notes": "Great pace today"
}
```

**Response**:
```http
HTTP/1.1 201 Created
Content-Type: application/json

{
  "id": "550e8400-e29b-41d4-a716-446655440001",
  "name": "Evening Run",
  "type": "cardio",
  "duration": 45,
  "intensity": 8,
  "date": "2025-01-08T18:30:00Z",
  "notes": "Great pace today"
}
```

**Error Responses**:
```http
HTTP/1.1 400 Bad Request
Content-Type: application/json

{
  "message": "Invalid workout data",
  "errors": [
    {
      "field": "type",
      "message": "must be one of: strength, cardio, flexibility, sports, other"
    }
  ]
}
```

**Business Logic**: 
- Auto-generate UUID for `id`
- Set `date` to current timestamp
- After creating workout, update user stats:
  - Increment `totalWorkouts`
  - Update streak logic (see UserStats section)
  - Set `lastWorkoutDate` to current time

---

#### DELETE /api/workouts/{id}
**Purpose**: Delete a specific workout

**Request**:
```http
DELETE /api/workouts/550e8400-e29b-41d4-a716-446655440001
```

**Response**:
```http
HTTP/1.1 204 No Content
```

**Error Responses**:
```http
HTTP/1.1 404 Not Found
Content-Type: application/json

{
  "message": "Workout not found"
}
```

### 2. Workout Plans API

#### GET /api/workout-plans
**Purpose**: Retrieve all workout plans, sorted by day of week

**Request**:
```http
GET /api/workout-plans
Accept: application/json
```

**Response**:
```http
HTTP/1.1 200 OK
Content-Type: application/json

[
  {
    "id": "550e8400-e29b-41d4-a716-446655440010",
    "dayOfWeek": 1,
    "name": "Upper Body Strength",
    "duration": 45,
    "exerciseCount": 6,
    "focus": ["Chest", "Back", "Arms"],
    "status": "today",
    "week": 3
  },
  {
    "id": "550e8400-e29b-41d4-a716-446655440011",
    "dayOfWeek": 2,
    "name": "Active Recovery",
    "duration": 20,
    "exerciseCount": 0,
    "focus": ["Stretching"],
    "status": "rest",
    "week": 3
  }
]
```

---

#### POST /api/workout-plans
**Purpose**: Create a new workout plan

**Request**:
```http
POST /api/workout-plans
Content-Type: application/json

{
  "dayOfWeek": 1,
  "name": "Custom Upper Body",
  "duration": 60,
  "exerciseCount": 8,
  "focus": ["Chest", "Shoulders"],
  "status": "upcoming",
  "week": 4
}
```

**Response**:
```http
HTTP/1.1 201 Created
Content-Type: application/json

{
  "id": "550e8400-e29b-41d4-a716-446655440020",
  "dayOfWeek": 1,
  "name": "Custom Upper Body", 
  "duration": 60,
  "exerciseCount": 8,
  "focus": ["Chest", "Shoulders"],
  "status": "upcoming",
  "week": 4
}
```

---

#### PUT /api/workout-plans/{id}
**Purpose**: Update an existing workout plan

**Request**:
```http
PUT /api/workout-plans/550e8400-e29b-41d4-a716-446655440020
Content-Type: application/json

{
  "status": "completed",
  "duration": 55
}
```

**Response**:
```http
HTTP/1.1 200 OK
Content-Type: application/json

{
  "id": "550e8400-e29b-41d4-a716-446655440020",
  "dayOfWeek": 1,
  "name": "Custom Upper Body",
  "duration": 55,
  "exerciseCount": 8,
  "focus": ["Chest", "Shoulders"],
  "status": "completed",
  "week": 4
}
```

**Note**: This is a partial update - only send fields that need to be changed.

### 3. User Stats API

#### GET /api/user-stats
**Purpose**: Retrieve user statistics and streak information

**Request**:
```http
GET /api/user-stats
Accept: application/json
```

**Response**:
```http
HTTP/1.1 200 OK
Content-Type: application/json

{
  "id": "550e8400-e29b-41d4-a716-446655440100",
  "currentStreak": 12,
  "bestStreak": 18,
  "totalWorkouts": 147,
  "lastWorkoutDate": "2025-01-08T18:30:00Z"
}
```

**Streak Logic**:
- `currentStreak`: Days with consecutive workouts
- If last workout was yesterday, increment streak
- If last workout was today, don't change streak
- If last workout was more than 1 day ago, reset streak to 1
- Update `bestStreak` if `currentStreak` exceeds it

## Sample Data for Development

Use this sample data to initialize your database:

### Sample Workouts
```json
[
  {
    "name": "Morning Push-ups",
    "type": "strength",
    "duration": 30,
    "intensity": 7,
    "notes": "Felt strong today"
  },
  {
    "name": "Evening Jog",
    "type": "cardio", 
    "duration": 45,
    "intensity": 6,
    "notes": "Nice weather"
  }
]
```

### Sample Workout Plans  
```json
[
  {
    "dayOfWeek": 1,
    "name": "Upper Body Strength",
    "duration": 45,
    "exerciseCount": 6,
    "focus": ["Chest", "Back", "Arms"],
    "status": "today",
    "week": 3
  },
  {
    "dayOfWeek": 2, 
    "name": "Active Recovery",
    "duration": 20,
    "exerciseCount": 0,
    "focus": ["Stretching"],
    "status": "rest",
    "week": 3
  },
  {
    "dayOfWeek": 3,
    "name": "Lower Body Power", 
    "duration": 50,
    "exerciseCount": 7,
    "focus": ["Legs", "Glutes", "Core"],
    "status": "upcoming",
    "week": 3
  },
  {
    "dayOfWeek": 4,
    "name": "Cardio Intervals",
    "duration": 35,
    "exerciseCount": 5,
    "focus": ["Cardio", "Endurance"], 
    "status": "upcoming",
    "week": 3
  },
  {
    "dayOfWeek": 5,
    "name": "Full Body Circuit",
    "duration": 40,
    "exerciseCount": 8,
    "focus": ["Full Body", "Functional"],
    "status": "upcoming",
    "week": 3
  },
  {
    "dayOfWeek": 6,
    "name": "Outdoor Activity",
    "duration": 60,
    "exerciseCount": 0,
    "focus": ["Cardio", "Recreation"],
    "status": "flexible",
    "week": 3
  }
]
```

### Sample User Stats
```json
{
  "currentStreak": 12,
  "bestStreak": 18, 
  "totalWorkouts": 147,
  "lastWorkoutDate": "2025-01-08T18:30:00Z"
}
```

## Frontend Integration Notes

### React Query Integration
The frontend uses TanStack Query (React Query) for API calls:

- **GET requests**: Automatic via query keys like `['/api/workouts']`
- **POST/PUT/DELETE**: Use mutations with `apiRequest()` helper
- **Cache invalidation**: After mutations, invalidate relevant query keys

### API Client Helper
The frontend uses this helper function for mutations:
```javascript
async function apiRequest(method, url, data) {
  const res = await fetch(url, {
    method,
    headers: data ? { "Content-Type": "application/json" } : {},
    body: data ? JSON.stringify(data) : undefined,
    credentials: "include",
  });
  
  if (!res.ok) throw new Error(`API Error: ${res.status}`);
  return res;
}
```

### Error Handling
- Return proper HTTP status codes
- Include descriptive error messages
- For validation errors, include field-specific details

## Spring Boot Implementation Tips

1. **Controllers**: Create separate controllers for each entity (WorkoutController, WorkoutPlanController, UserStatsController)

2. **Services**: Implement business logic in service classes, especially streak calculation

3. **Repositories**: Use JPA repositories for data access

4. **Validation**: Use Bean Validation annotations on DTOs

5. **CORS Configuration**: 
```java
@CrossOrigin(origins = "http://localhost:5000", allowCredentials = true)
```

6. **Exception Handling**: Create global exception handlers for consistent error responses

7. **Database**: Use PostgreSQL with JPA/Hibernate for persistence

This documentation provides everything you need to implement the Spring Boot backend that will work seamlessly with the existing React frontend!